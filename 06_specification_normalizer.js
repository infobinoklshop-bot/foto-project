/**
 * ========================================
 * –ú–û–î–£–õ–¨ 06: –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–Ø –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö
 * ========================================
 *
 * –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –æ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–æ–≤ –≤ —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
 * –Ω–∞ –æ—Å–Ω–æ–≤–µ JSON-—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞
 */

// =============================================================================
// –ú–ê–ü–ü–ò–ù–ì –ü–ê–†–ê–ú–ï–¢–†–û–í –ü–û–°–¢–ê–í–©–ò–ö–û–í
// =============================================================================

const SPEC_MAPPING = {
  '–ü–∞—Ä–∞–º–µ—Ç—Ä: –ö—Ä–∞—Ç–Ω–æ—Å—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∏—è, –∫—Ä–∞—Ç': {
    veber: ['–£–≤–µ–ª–∏—á–µ–Ω–∏–µ', '–ö—Ä–∞—Ç–Ω–æ—Å—Ç—å', 'Zoom', 'Magnification'],
    sturman: ['–£–≤–µ–ª–∏—á–µ–Ω–∏–µ', '–ö—Ä–∞—Ç–Ω–æ—Å—Ç—å', 'Magnification'],
    normalizer: (value) => {
      const match = value.match(/(\d+)/);
      return match ? match[1] : value;
    }
  },

  '–ü–∞—Ä–∞–º–µ—Ç—Ä: –î–∏–∞–º–µ—Ç—Ä –æ–±—ä–µ–∫—Ç–∏–≤–∞, –º–º': {
    veber: ['–î–∏–∞–º–µ—Ç—Ä –æ–±—ä–µ–∫—Ç–∏–≤–∞', '–ê–ø–µ—Ä—Ç—É—Ä–∞', 'Objective', '–î–∏–∞–º. –æ–±—ä–µ–∫—Ç–∏–≤–∞'],
    sturman: ['–û–±—ä–µ–∫—Ç–∏–≤', '–î–∏–∞–º–µ—Ç—Ä –ª–∏–Ω–∑—ã', '–î–∏–∞–º–µ—Ç—Ä –æ–±—ä–µ–∫—Ç–∏–≤–∞'],
    normalizer: (value) => {
      const match = value.match(/(\d+)/);
      return match ? match[1] : value;
    }
  },

  '–ü–∞—Ä–∞–º–µ—Ç—Ä: –ü—Ä–∏–∑–º–µ–Ω–Ω–∞—è —Å—Ö–µ–º–∞': {
    veber: ['–¢–∏–ø –ø—Ä–∏–∑–º—ã', '–ü—Ä–∏–∑–º—ã', 'Prism type', '–ü—Ä–∏–∑–º–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'],
    sturman: ['–ü—Ä–∏–∑–º–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞', '–ü—Ä–∏–∑–º—ã', '–¢–∏–ø –ø—Ä–∏–∑–º—ã'],
    normalizer: (value) => {
      if (/porro/i.test(value)) return 'PORRO';
      if (/roof/i.test(value)) return 'ROOF';
      return value.toUpperCase();
    }
  },

  '–ü–∞—Ä–∞–º–µ—Ç—Ä: –ú–∞—Ä–∫–∞ —Å—Ç–µ–∫–ª–∞': {
    veber: ['–°—Ç–µ–∫–ª–æ –ø—Ä–∏–∑–º', '–ú–∞—Ç–µ—Ä–∏–∞–ª –ø—Ä–∏–∑–º', '–¢–∏–ø —Å—Ç–µ–∫–ª–∞', '–ú–∞—Ä–∫–∞ —Å—Ç–µ–∫–ª–∞'],
    sturman: ['–ú–∞—Ç–µ—Ä–∏–∞–ª –ø—Ä–∏–∑–º', '–°—Ç–µ–∫–ª–æ', '–ú–∞—Ä–∫–∞ —Å—Ç–µ–∫–ª–∞'],
    normalizer: (value) => {
      if (/bak-?4/i.test(value)) return 'BaK-4';
      if (/bk-?7/i.test(value)) return 'BK-7';
      if (/\bED\b/i.test(value)) return 'ED';
      if (/k-?9/i.test(value)) return 'K-9';
      return value;
    }
  },

  '–ü–∞—Ä–∞–º–µ—Ç—Ä: –û–ø—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ': {
    veber: ['–ü–æ–∫—Ä—ã—Ç–∏–µ –ª–∏–Ω–∑', '–û–ø—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ', '–ü—Ä–æ—Å–≤–µ—Ç–ª–µ–Ω–∏–µ'],
    sturman: ['–ü–æ–∫—Ä—ã—Ç–∏–µ', '–ü—Ä–æ—Å–≤–µ—Ç–ª–µ–Ω–∏–µ', '–û–ø—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ'],
    normalizer: (value) => {
      if (/fmc|–ø–æ–ª–Ω.*–º–Ω–æ–≥–æ—Å–ª–æ–π–Ω/i.test(value)) return '–ü–æ–ª–Ω–æ–µ –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω–æ–µ (FMC)';
      if (/–º–Ω–æ–≥–æ—Å–ª–æ–π–Ω/i.test(value)) return '–ú–Ω–æ–≥–æ—Å–ª–æ–π–Ω–æ–µ';
      if (/–æ–¥–Ω–æ—Å–ª–æ–π–Ω/i.test(value)) return '–û–¥–Ω–æ—Å–ª–æ–π–Ω–æ–µ';
      return value;
    }
  },

  '–ü–∞—Ä–∞–º–µ—Ç—Ä: –ë—Ä–µ–Ω–¥': {
    veber: ['–ë—Ä–µ–Ω–¥', '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å', 'Brand'],
    sturman: ['–ë—Ä–µ–Ω–¥', '–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å', 'Brand'],
    normalizer: (value) => {
      // –ü–µ—Ä–≤–∞—è –±—É–∫–≤–∞ –∑–∞–≥–ª–∞–≤–Ω–∞—è, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∫–∞–∫ –µ—Å—Ç—å
      return value.charAt(0).toUpperCase() + value.slice(1).toLowerCase();
    }
  },

  '–ü–∞—Ä–∞–º–µ—Ç—Ä: –í–µ—Å, –≥': {
    veber: ['–í–µ—Å', 'Weight', '–ú–∞—Å—Å–∞'],
    sturman: ['–í–µ—Å', 'Weight'],
    normalizer: (value) => {
      const match = value.match(/(\d+)/);
      return match ? match[1] : value;
    }
  },

  '–ü–∞—Ä–∞–º–µ—Ç—Ä: –ó–∞—â–∏—Ç–∞ –æ—Ç –≤–ª–∞–≥–∏ –∏ –ø—ã–ª–∏': {
    veber: ['–í–ª–∞–≥–æ–∑–∞—â–∏—Ç–∞', '–í–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º–æ—Å—Ç—å', '–ó–∞—â–∏—Ç–∞ –æ—Ç –≤–ª–∞–≥–∏'],
    sturman: ['–í–ª–∞–≥–æ–∑–∞—â–∏—Ç–∞', '–ó–∞—â–∏—Ç–∞', '–í–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º–æ—Å—Ç—å'],
    normalizer: (value) => {
      if (/–≤–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º|ipx7|ipx8|–ø–æ–ª–Ω.*–ø–æ–≥—Ä—É–∂/i.test(value)) return '–í–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏—Ü–∞–µ–º—ã–π';
      if (/–≤–æ–¥–æ–∑–∞—â–∏—Ç|ipx6/i.test(value)) return '–í–æ–¥–æ–∑–∞—â–∏—â–µ–Ω–Ω—ã–π';
      if (/–≤–ª–∞–≥–æ–∑–∞—â–∏—Ç|ipx4|ipx5/i.test(value)) return '–í–ª–∞–≥–æ–∑–∞—â–∏—â–µ–Ω–Ω—ã–π';
      return value;
    }
  },

  '–ü–∞—Ä–∞–º–µ—Ç—Ä: –ì–∞–∑–æ–≤–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ': {
    veber: ['–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ', '–ì–∞–∑', 'Nitrogen'],
    sturman: ['–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ', '–ì–∞–∑–æ–≤–æ–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ'],
    normalizer: (value) => {
      if (/–∞–∑–æ—Ç/i.test(value) || /nitrogen/i.test(value)) return '–ê–∑–æ—Ç';
      return value;
    }
  },

  '–ü–∞—Ä–∞–º–µ—Ç—Ä: –¶–≤–µ—Ç': {
    veber: ['–¶–≤–µ—Ç', 'Color', '–û–∫—Ä–∞—Å–∫–∞'],
    sturman: ['–¶–≤–µ—Ç', 'Color'],
    normalizer: (value) => {
      const colorMap = {
        '—á–µ—Ä–Ω—ã–π': '–ß—ë—Ä–Ω—ã–π', 'black': '–ß—ë—Ä–Ω—ã–π',
        '–∑–µ–ª–µ–Ω—ã–π': '–ó–µ–ª—ë–Ω—ã–π', 'green': '–ó–µ–ª—ë–Ω—ã–π',
        '–∫–æ—Ä–∏—á–Ω–µ–≤—ã–π': '–ö–æ—Ä–∏—á–Ω–µ–≤—ã–π', 'brown': '–ö–æ—Ä–∏—á–Ω–µ–≤—ã–π',
        '–∫–∞–º—É—Ñ–ª—è–∂': '–ö–∞–º—É—Ñ–ª—è–∂–Ω—ã–π', 'camo': '–ö–∞–º—É—Ñ–ª—è–∂–Ω—ã–π',
        '—Å–µ—Ä—ã–π': '–°–µ—Ä—ã–π', 'gray': '–°–µ—Ä—ã–π', 'grey': '–°–µ—Ä—ã–π'
      };
      const lower = value.toLowerCase();
      return colorMap[lower] || value;
    }
  }
};

// =============================================================================
// –û–°–ù–û–í–ù–´–ï –§–£–ù–ö–¶–ò–ò
// =============================================================================

/**
 * –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–Ø –•–ê–†–ê–ö–¢–ï–†–ò–°–¢–ò–ö
 *
 * @param {Object} rawSpecs - –°—ã—Ä—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –æ—Ç –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞
 * @param {string} supplier - –ò–º—è –ø–æ—Å—Ç–∞–≤—â–∏–∫–∞ (veber, sturman)
 * @returns {Object} –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
 */
function normalizeSpecifications(rawSpecs, supplier) {
  try {
    logInfo(`üîÑ –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –æ—Ç ${supplier}`);

    if (typeof rawSpecs === 'string') {
      rawSpecs = JSON.parse(rawSpecs);
    }

    const normalized = {};
    const unmapped = {};

    // –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –º–∞–ø–ø–∏–Ω–≥—É
    for (const [targetParam, config] of Object.entries(SPEC_MAPPING)) {
      const synonyms = config[supplier] || [];

      // –ò—â–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
      for (const synonym of synonyms) {
        for (const [key, value] of Object.entries(rawSpecs)) {
          if (key.toLowerCase().includes(synonym.toLowerCase())) {
            let normalizedValue = value;

            // –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ç–æ—Ä
            if (config.normalizer) {
              try {
                normalizedValue = config.normalizer(value);
              } catch (e) {
                logWarning(`‚ö†Ô∏è –û—à–∏–±–∫–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ ${targetParam}: ${e.message}`);
              }
            }

            normalized[targetParam] = normalizedValue;
            delete rawSpecs[key];
            break;
          }
        }
        if (normalized[targetParam]) break;
      }
    }

    // –û—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ unmapped
    for (const [key, value] of Object.entries(rawSpecs)) {
      if (value) unmapped[key] = value;
    }

    logInfo(`‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–æ: ${Object.keys(normalized).length} –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤`);
    if (Object.keys(unmapped).length > 0) {
      logWarning(`‚ö†Ô∏è –ù–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–æ: ${Object.keys(unmapped).length} –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤`);
    }

    return {
      normalized: normalized,
      unmapped: unmapped
    };

  } catch (error) {
    handleError(error, '–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫');
    return { normalized: {}, unmapped: rawSpecs };
  }
}

/**
 * –í–ê–õ–ò–î–ê–¶–ò–Ø –ü–û –°–ü–†–ê–í–û–ß–ù–ò–ö–£
 *
 * @param {Object} specs - –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
 * @returns {Object} –†–µ–∑—É–ª—å—Ç–∞—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏
 */
function validateAgainstReference(specs) {
  try {
    logInfo('‚úÖ –í–∞–ª–∏–¥–∏—Ä—É–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –ø–æ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫—É');

    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫
    const reference = loadSpecificationReference();

    const errors = [];
    const warnings = [];

    for (const [param, value] of Object.entries(specs)) {
      const refEntry = reference.find(e =>
        e['–ü–∞—Ä–∞–º–µ—Ç—Ä (—ç—Ç–∞–ª–æ–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)'] === param
      );

      if (!refEntry) {
        warnings.push(`–ü–∞—Ä–∞–º–µ—Ç—Ä "${param}" –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ`);
        continue;
      }

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
      if (refEntry['–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ'] === '–¥–∞' && !value) {
        errors.push(`–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ "${param}" –ø—É—Å—Ç–æ–µ`);
      }

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞
      if (refEntry['–¢–∏–ø –ø–æ–ª—è'] === '—á–∏—Å–ª–æ' && isNaN(value)) {
        errors.push(`"${param}" –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —á–∏—Å–ª–æ–º, –ø–æ–ª—É—á–µ–Ω–æ: ${value}`);
      }

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ enum
      if (refEntry['–¢–∏–ø –ø–æ–ª—è'] === 'enum') {
        const allowedValues = refEntry['–î–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (enum)']
          .split(';')
          .map(s => s.trim())
          .filter(s => s);

        if (allowedValues.length > 0 && !allowedValues.includes(value)) {
          warnings.push(`"${param}": –∑–Ω–∞—á–µ–Ω–∏–µ "${value}" –Ω–µ –≤ —Å–ø–∏—Å–∫–µ: ${allowedValues.join(', ')}`);
        }
      }
    }

    return {
      isValid: errors.length === 0,
      errors: errors,
      warnings: warnings
    };

  } catch (error) {
    handleError(error, '–í–∞–ª–∏–¥–∞—Ü–∏—è —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫');
    return { isValid: false, errors: [error.message], warnings: [] };
  }
}

/**
 * –ó–ê–ì–†–£–ó–ö–ê –°–ü–†–ê–í–û–ß–ù–ò–ö–ê
 */
function loadSpecificationReference() {
  try {
    // –ó–∞–≥—Ä—É–∂–∞–µ–º JSON-—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∏–∑ data/
    const jsonUrl = 'https://raw.githubusercontent.com/yourusername/yourrepo/main/data/JSON-—Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫.json';

    // –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫
    // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª —á–µ—Ä–µ–∑ DriveApp –∏–ª–∏ –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥

    // –ü–æ–∫–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –±–∞–∑–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
    return BASIC_REFERENCE;

  } catch (error) {
    logError('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞', error);
    return [];
  }
}

// –ë–∞–∑–æ–≤—ã–π —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ (—Å–æ–∫—Ä–∞—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–µ–∑ —Ñ–∞–π–ª–∞)
const BASIC_REFERENCE = [
  {
    '–ü–∞—Ä–∞–º–µ—Ç—Ä (—ç—Ç–∞–ª–æ–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)': '–ü–∞—Ä–∞–º–µ—Ç—Ä: –ö—Ä–∞—Ç–Ω–æ—Å—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∏—è, –∫—Ä–∞—Ç',
    '–¢–∏–ø –ø–æ–ª—è': '—Ñ–æ—Ä–º–∞—Ç',
    '–î–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (enum)': '–¶–µ–ª–æ–µ —á–∏—Å–ª–æ',
    '–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ': ''
  },
  {
    '–ü–∞—Ä–∞–º–µ—Ç—Ä (—ç—Ç–∞–ª–æ–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)': '–ü–∞—Ä–∞–º–µ—Ç—Ä: –î–∏–∞–º–µ—Ç—Ä –æ–±—ä–µ–∫—Ç–∏–≤–∞, –º–º',
    '–¢–∏–ø –ø–æ–ª—è': '—Ñ–æ—Ä–º–∞—Ç',
    '–î–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (enum)': '–¶–µ–ª–æ–µ —á–∏—Å–ª–æ',
    '–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ': ''
  },
  {
    '–ü–∞—Ä–∞–º–µ—Ç—Ä (—ç—Ç–∞–ª–æ–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)': '–ü–∞—Ä–∞–º–µ—Ç—Ä: –ü—Ä–∏–∑–º–µ–Ω–Ω–∞—è —Å—Ö–µ–º–∞',
    '–¢–∏–ø –ø–æ–ª—è': 'enum',
    '–î–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (enum)': 'PORRO; ROOF',
    '–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ': ''
  },
  {
    '–ü–∞—Ä–∞–º–µ—Ç—Ä (—ç—Ç–∞–ª–æ–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)': '–ü–∞—Ä–∞–º–µ—Ç—Ä: –ú–∞—Ä–∫–∞ —Å—Ç–µ–∫–ª–∞',
    '–¢–∏–ø –ø–æ–ª—è': 'enum',
    '–î–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (enum)': 'BaK-4; BK-7; ED; K-9',
    '–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ': ''
  },
  {
    '–ü–∞—Ä–∞–º–µ—Ç—Ä (—ç—Ç–∞–ª–æ–Ω–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)': '–ü–∞—Ä–∞–º–µ—Ç—Ä: –û–ø—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ',
    '–¢–∏–ø –ø–æ–ª—è': 'enum',
    '–î–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (enum)': '–û–¥–Ω–æ—Å–ª–æ–π–Ω–æ–µ; –ú–Ω–æ–≥–æ—Å–ª–æ–π–Ω–æ–µ; –ü–æ–ª–Ω–æ–µ –º–Ω–æ–≥–æ—Å–ª–æ–π–Ω–æ–µ (FMC)',
    '–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ': ''
  }
];

/**
 * –¢–ï–°–¢ –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–ò
 */
function testNormalization() {
  logInfo('üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é');

  const testSpecs = {
    '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ': '10x',
    '–î–∏–∞–º–µ—Ç—Ä –æ–±—ä–µ–∫—Ç–∏–≤–∞': '42 –º–º',
    '–ü—Ä–∏–∑–º—ã': 'Roof',
    '–°—Ç–µ–∫–ª–æ –ø—Ä–∏–∑–º': 'BaK4',
    '–ü–æ–∫—Ä—ã—Ç–∏–µ –ª–∏–Ω–∑': 'FMC',
    '–ë—Ä–µ–Ω–¥': 'VEBER',
    '–í–µ—Å': '580 –≥'
  };

  const result = normalizeSpecifications(testSpecs, 'veber');
  logInfo('–†–µ–∑—É–ª—å—Ç–∞—Ç:', JSON.stringify(result, null, 2));

  const validation = validateAgainstReference(result.normalized);
  logInfo('–í–∞–ª–∏–¥–∞—Ü–∏—è:', JSON.stringify(validation, null, 2));
}
